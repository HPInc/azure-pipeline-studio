# aps-format=false
steps:
- ${{ if parameters.enableMsixSigning }}:
  - template: /steps/template-one.yaml
    parameters:
      param1: value1
  - template: /steps/template-two.yaml
    parameters:
      param2: value2
  - template: /steps/template-three.yaml
    parameters:
      param3: value3
- bash: echo "After conditional block"
---
steps:
- ${{ if parameters.publishArtifacts }}:
  - bash: |
      echo "Publishing artifacts"
      zip_dir="$(pwd)/artifacts"
      mkdir -p "${zip_dir}"
      cp *.zip "${zip_dir}/"
    displayName: Stage Artifacts
  - ${{ each connection in split(parameters.connections, ',') }}:
    - ${{ if ne(trim(connection), '') }}:
      - task: PublishTask@0
        inputs:
          connection: ${{ connection }}
- bash: echo "Final step"
---
steps:
- task: Setup@1
  displayName: Setup
- ${{ if eq(parameters.option, 'A') }}:
  - bash: echo "Option A"
- ${{ elseif eq(parameters.option, 'B') }}:
  - bash: echo "Option B"
- ${{ each config in parameters.configurations }}:
  - task: Process@1
    inputs:
      config: ${{ config }}
- bash: echo "Cleanup"
---
stages:
- ${{ if eq(parameters.enableBuild, true) }}:
  - ${{ if eq(parameters.enableTests, true) }}:
    - stage: BuildAndTest
      jobs:
      - job: Test
- ${{ if eq(parameters.enableDeploy, true) }}:
  - ${{ if eq(parameters.environment, 'prod') }}:
    - stage: ProdDeploy
- stage: AlwaysRun
---
parameters:
- name: param1
  type: string
  default: value1
- name: param2
  type: string
  default: value2
- name: param3
  type: string
  default: value3

variables:
- name: var1
  value: val1
- name: var2
  value: val2
- name: var3
  value: val3
---
steps:
- task: NodeTool@0
  inputs:
    versionSpec: '18.x'
- bash: npm install
- bash: npm test
---
steps:
- bash: |
    echo "Multi-line"
    echo "script"
  displayName: Run Script
- bash: echo "Next step"
---
steps:
- task: Setup@1
- ${{ if eq(parameters.mode, 'build') }}:
  - bash: echo "Building"
- ${{ elseif eq(parameters.mode, 'test') }}:
  - bash: echo "Testing"
- bash: echo "Done"
